<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TalknType - Voice to Text</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
      }

      .slider {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #000;
      }

      .slider-container {
        width: 100%;
        height: 100%;
        position: relative;
      }

      .slider-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        position: absolute;
        opacity: 0;
        transition: opacity 1s ease-in-out;
      }

      .slider-container img.active {
        opacity: 1;
      }

      header {
        background: white;
        text-align: center;
        padding: 20px 0;
        animation: zoomInOut 3s ease-in-out infinite;
      }

      @keyframes zoomInOut {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.1);
        }
      }

      header img {
        max-width: 150px;
      }

      .voice-box {
        padding: 40px 20px;
        background-color: #fff;
        text-align: center;
      }

      .voice-container {
        max-width: 800px;
        margin: auto;
        background: #fefefe;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.08);
        border: 1px solid #ccc;
      }

      h2 {
        font-size: 24px;
        margin-bottom: 16px;
      }

      select,
      button,
      textarea {
        font-size: 16px;
        margin: 10px 5px;
      }

      select {
        padding: 10px;
        border-radius: 6px;
        border: 1px solid #aaa;
      }

      button {
        padding: 12px 20px;
        border: none;
        border-radius: 30px;
        background: linear-gradient(to right, #00c9ff, #92fe9d);
        color: white;
        cursor: pointer;
        transition: 0.3s ease;
      }

      button:hover {
        transform: scale(1.05);
      }

      textarea {
        width: 100%;
        height: 200px;
        padding: 15px;
        border-radius: 10px;
        border: 1px solid #ccc;
        resize: vertical;
      }

      canvas {
        display: block;
        margin: 20px auto;
        background: #000;
        border-radius: 10px;
      }

      @media (max-width: 768px) {
        header img {
          max-width: 100px;
        }

        h2 {
          font-size: 20px;
        }

        textarea {
          height: 150px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Slider -->
    <div class="slider">
      <div class="slider-container">
        <img src="Image.jpg" class="active" alt="Slide 1" />
        <img src="Image2.jpg" alt="Slide 2" />
      </div>
    </div>

    <!-- Logo -->
    <header>
      <img src="logo.jpg" alt="TalknType Logo" />
    </header>

    <!-- Voice Typing -->
    <section class="voice-box">
      <div class="voice-container">
        <h2>üé§ Start Typing by Voice</h2>

        <select id="languageSelect">
          <option value="en-IN">English (India)</option>
          <option value="hi-IN">Hindi</option>
          <option value="mr-IN">Marathi</option>
        </select>

        <br />

        <button id="talkBtn">üéôÔ∏è Start Talking</button>
        <button id="printBtn">üñ®Ô∏è Print</button>

        <br />

        <textarea
          id="output"
          placeholder="Your speech will appear here..."
        ></textarea>

        <canvas id="visualizer" width="300" height="100"></canvas>
      </div>
    </section>

    <script>
      const talkBtn = document.getElementById("talkBtn");
      const printBtn = document.getElementById("printBtn");
      const output = document.getElementById("output");
      const languageSelect = document.getElementById("languageSelect");
      const canvas = document.getElementById("visualizer");
      const ctx = canvas.getContext("2d");

      const slides = document.querySelectorAll(".slider-container img");
      let slideIndex = 0;
      let recognition, audioCtx, analyser, source;
      let running = false;
      let fullText = "";

      function showSlide(i) {
        slides.forEach((slide, idx) =>
          slide.classList.toggle("active", idx === i)
        );
      }

      setInterval(() => {
        slideIndex = (slideIndex + 1) % slides.length;
        showSlide(slideIndex);
      }, 5000);

      function startSpeechRecognition() {
        if (!("webkitSpeechRecognition" in window)) {
          alert("Use Google Chrome for best experience.");
          return;
        }

        recognition = new webkitSpeechRecognition();
        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.lang = languageSelect.value;

        recognition.onresult = (event) => {
          let interim = "";
          for (let i = event.resultIndex; i < event.results.length; ++i) {
            const transcript = event.results[i][0].transcript;
            if (event.results[i].isFinal) {
              fullText += transcript + " ";
            } else {
              interim += transcript;
            }
          }
          output.value = fullText + interim;
        };

        recognition.onerror = (event) => {
          console.error("Recognition Error:", event.error);
        };

        recognition.start();
      }

      function startAudioVisualization() {
        navigator.mediaDevices
          .getUserMedia({ audio: true })
          .then((stream) => {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            analyser = audioCtx.createAnalyser();
            source = audioCtx.createMediaStreamSource(stream);
            source.connect(analyser);

            analyser.fftSize = 64;
            const bufferLength = analyser.frequencyBinCount;
            const dataArray = new Uint8Array(bufferLength);

            function draw() {
              requestAnimationFrame(draw);
              analyser.getByteFrequencyData(dataArray);

              ctx.clearRect(0, 0, canvas.width, canvas.height);
              ctx.fillStyle = "lime";
              const barWidth = canvas.width / bufferLength;
              for (let i = 0; i < bufferLength; i++) {
                const barHeight = dataArray[i];
                ctx.fillRect(
                  i * barWidth,
                  canvas.height - barHeight,
                  barWidth - 1,
                  barHeight
                );
              }
            }

            draw();
          })
          .catch((err) => {
            alert("Microphone access is required.");
            console.error("Mic Error:", err);
          });
      }

      talkBtn.onclick = () => {
        if (!running) {
          fullText = output.value;
          startSpeechRecognition();
          startAudioVisualization();
          talkBtn.innerText = "‚õî Stop Talking";
          running = true;
        } else {
          recognition && recognition.stop();
          audioCtx && audioCtx.close();
          talkBtn.innerText = "üéôÔ∏è Start Talking";
          running = false;
        }
      };

      printBtn.onclick = () => {
        const win = window.open("", "", "width=600,height=600");
        win.document.write(`<pre>${output.value}</pre>`);
        win.document.close();
        win.print();
      };
    </script>
  </body>
</html>
